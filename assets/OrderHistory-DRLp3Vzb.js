import{r as i,m as T,j as t}from"./index-Rlby0J6q.js";import{h as I,F as L,i as N,l as O}from"./vi-BY-cvh_o.js";import{u as V}from"./userService-DXzYnLiy.js";import{n as h}from"./DefaultLayout-B1IAJ90r.js";import"./index.esm-CNoClFMc.js";import{C as q,a as B}from"./CRow-CddhGkHr.js";import{C as y,a as M}from"./CCardBody-C_eNDp3N.js";import{C as z}from"./CCardHeader-BJ5jTlQf.js";import"./index.es-BZK4ciJx.js";import"./cil-lock-locked-DmxpJbVL.js";const te=()=>{i.useRef(null);const D=T(s=>s.userLogged);i.useState([]);const[H,m]=i.useState(!0),[G,f]=i.useState(!1),[C,j]=i.useState([]),[x,v]=i.useState(0),[w,k]=i.useState(0),[S,W]=i.useState([]);i.useEffect(()=>{E()},[]);function b(){const s=new Date,a=s.getDay(),r=s.getDate()-a+(a===0?-6:1),n=new Date(s.setDate(r)),o=new Date(s.setDate(n.getDate()+6));return{startOfWeek:n,endOfWeek:o}}const E=async()=>{try{const s=await V.getAllDataLunch();m(!1),f(!1);let a=[];const r=new Date;s.map(e=>{new Date(e.date).getFullYear()==r.getFullYear()&&a.push(e)}),a.map(e=>{e.start=e.date,e.title=I(e.date).format("DD/MM/YYYY"),e.allDay=!0});let n=[];a.map(e=>{e.foods&&e.foods.map(c=>{let d=c.orders.filter(u=>u.empCode===D.emp_code);d.length>0&&(d.map(u=>u.date=e.date),n=n.concat(d))})});let o=[];n.map(e=>{const c={start:e.date,title:e.quantity+" "+e.foodName,allDay:!0};o.push(c)}),W(n),j(o);let l=0;n.map(e=>l+=e.quantity*e.price*1e3),console.log(l),k(l);const{startOfWeek:Y,endOfWeek:R}=b();p(n,Y,R)}catch(s){console.log(s),m(!1),f(!1)}},p=(s,a,r)=>{try{const n=g(s,a,r);let o=0;n.map(l=>o+=l.quantity*l.price*1e3),v(o)}catch{}};function g(s,a,r){return s.filter(o=>{const l=new Date(o.date);return l>=a&&l<=r})}function A(s){return t.jsx("div",{style:{padding:"10px",borderRadius:"10px",backgroundColor:"#007bff",color:"white",overflow:"hidden",whiteSpace:"normal"},children:t.jsx("b",{children:s.event.title})})}function F(s){const{start:a,end:r}=s,n=g(S,a,r);p(n,a,r)}return t.jsx(t.Fragment,{children:t.jsx(q,{children:t.jsx(B,{xs:!0,children:t.jsxs(y,{className:"mb-4",children:[t.jsx(z,{children:"Tuần cơm"}),t.jsxs(M,{children:[t.jsxs(y,{className:"mb-4",style:{marginTop:10,padding:15,display:"flex",flexDirection:"row",justifyContent:"space-between"},children:[t.jsxs("div",{style:{display:"flex",flexDirection:"column"},children:[t.jsxs("span",{style:{fontSize:28,fontWeight:"bold",color:"#1B9E3E"},children:[h(x)," VNĐ"]}),t.jsx("span",{style:{},children:"Tổng tiền trong tuần"})]}),t.jsxs("div",{style:{display:"flex",flexDirection:"column"},children:[t.jsxs("span",{style:{fontSize:28,fontWeight:"bold",color:"#1B9E3E"},children:[h(w)," VNĐ"]}),t.jsx("span",{style:{},children:"Tổng tiền trong năm"})]})]}),t.jsx("div",{style:{marginVertical:10,height:5,borderRadius:10,backgroundColor:"#F3F4F7"}}),t.jsx("div",{style:{marginTop:10},children:t.jsx(L,{plugins:[N],initialView:"dayGridWeek",weekends:!1,locale:O,events:C,eventContent:A,datesSet:F})})]})]})})})})};export{te as default};
