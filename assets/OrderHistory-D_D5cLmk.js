import{r,m as Y,j as e,C as R}from"./index-DtMwsKRC.js";import{h as T,F as L,i as I,l as N}from"./vi-DuksugFO.js";import{u as V}from"./userService-DXzYnLiy.js";import{n as g}from"./DefaultLayout-DJ4j9LBL.js";import"./index.esm-WJJgkLSX.js";import{C as q,a as B}from"./CRow-IJJMPXaL.js";import{C as y,a as M}from"./CCardBody-UuwFkNfh.js";import{C as z}from"./CCardHeader-CVA6sFOF.js";import"./index.es-DSfl5hdB.js";import"./cil-lock-locked-DmxpJbVL.js";const $=()=>{r.useRef(null);const C=Y(s=>s.userLogged);r.useState([]);const[j,u]=r.useState(!0),[H,f]=r.useState(!1),[x,v]=r.useState([]),[S,D]=r.useState(0),[b,w]=r.useState(0),[p,E]=r.useState([]);r.useEffect(()=>{k()},[]);const k=async()=>{try{const s=await V.getAllDataLunch();u(!1),f(!1);let a=[];const l=new Date;s.map(t=>{new Date(t.date).getFullYear()==l.getFullYear()&&a.push(t)}),a.map(t=>{t.start=t.date,t.title=T(t.date).format("DD/MM/YYYY"),t.allDay=!0});let n=[];a.map(t=>{t.foods&&t.foods.map(c=>{let d=c.orders.filter(m=>m.empCode===C.emp_code);d.length>0&&(d.map(m=>m.date=t.date),n=n.concat(d))})});let i=[];n.map(t=>{const c={start:t.date,title:t.quantity+" "+t.foodName,allDay:!0};i.push(c)}),E(n),v(i);let o=0;n.map(t=>o+=t.quantity*t.price*1e3),w(o)}catch(s){console.log(s),u(!1),f(!1)}},A=(s,a,l)=>{try{const n=h(s,a,l);let i=0;n.map(o=>i+=o.quantity*o.price*1e3),D(i)}catch(n){console.log(n)}};function h(s,a,l){return s.filter(i=>{const o=new Date(i.date);return o>=a&&o<=l})}function F(s){return e.jsx("div",{style:{padding:"10px",borderRadius:"10px",backgroundColor:"#007bff",color:"white",overflow:"hidden",whiteSpace:"normal"},children:e.jsx("b",{children:s.event.title})})}function W(s){const{start:a,end:l}=s,n=h(p,a,l);A(n,a,l)}return e.jsx(e.Fragment,{children:e.jsx(q,{children:e.jsx(B,{xs:!0,children:e.jsxs(y,{className:"mb-4",children:[e.jsx(z,{children:"Tuần cơm"}),e.jsxs(M,{children:[e.jsxs(y,{className:"mb-4",style:{marginTop:10,padding:15,display:"flex",flexDirection:"row",justifyContent:"space-between"},children:[e.jsxs("div",{style:{display:"flex",flexDirection:"column"},children:[e.jsxs("span",{style:{fontSize:28,fontWeight:"bold",color:"#1B9E3E"},children:[g(S)," VNĐ"]}),e.jsx("span",{style:{},children:"Tổng tiền trong tuần"})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column"},children:[e.jsxs("span",{style:{fontSize:28,fontWeight:"bold",color:"#1B9E3E"},children:[g(b)," VNĐ"]}),e.jsx("span",{style:{},children:"Tổng tiền trong năm"})]})]}),j?e.jsx(R,{color:"primary",style:{marginLeft:15,marginTop:15}}):null,e.jsx("div",{style:{marginVertical:10,height:5,borderRadius:10,backgroundColor:"#F3F4F7"}}),e.jsx("div",{style:{marginTop:10},children:p.length>0?e.jsx(L,{plugins:[I],initialView:"dayGridWeek",weekends:!1,locale:N,events:x,eventContent:F,datesSet:W}):null})]})]})})})})};export{$ as default};
